steps:
  - label: "Build Go App"
    key: "build"
    commands: 
      - cd hello
      - go build
   
    plugins:
      - docker#v5.11.0:
          image: "golang:latest"
          volumes:
            - "./hello:/app"  
            
  - label: "APPROVE ME PLZ"
    key: "manualapproval"
    depends_on: "build"
    block: ":rocket: Are we ready to deploy?"

  - label: "Run Go App"
    depends_on: "manualapproval"
    prompt: "Who do you want to say hello to?"
    fields:
      - text: "Your name"
        key: "name"
    commands: 
      - cd hello
      - go build
      - chmod +x ./hello
      - ./hello $(buildkite-agent meta-data get name)
    plugins:
      - docker#v5.11.0:
          image: "golang:latest"
          volumes:
            - "./hello:/app" 
